<!DOCTYPE html>
<?global type Session.session_data += Count of int?>
<html>
  <head>
    <?prelude let cookies, session = Session.check ~init:(fun _ -> Count 0) request
         let count =
	   match Session.get_session_data session with
           | Count n -> n
           | _ -> -12
           | exception Not_found -> -100
         let _ = Session.set_session_data session (Count (count+1))?>
  </head>
  <body>
    <h1>dynamic hello!</h1>
    <ul>
      <li>item 1%
      <li>item 2%
      <li>item 3%
      <li>item 4%
      <li>views: <?= string_of_int count ?>
	         <?= if count mod 2 = 0 then
 	               {html|<p>even (<?= string_of_int count ?>)</p>|html}
                     else {html|<p>odd</p>|html} ?>
	?>
    </ul>
    <a href="."> escape from this file </a>
    <br/>
    request: <?ml let _ = printf "%a" Request.pp request ?>
  </body>
</html>
